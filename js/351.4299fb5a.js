"use strict";(self["webpackChunkp_blossom"]=self["webpackChunkp_blossom"]||[]).push([[351],{3779:function(e,t,o){o.r(t),o.d(t,{default:function(){return te}});var a=o(6252),n=o(3577);const s={class:"container"},l=(0,a._)("h1",{class:"fs-3 py-6"},"優惠券管理",-1),i={class:"card card-body border-0 shadow table-wrapper table-responsive"},p={class:"text-end"},d={class:"table table-hover align-middle"},u=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{class:"border-gray-200"},"名 稱"),(0,a._)("th",{class:"border-gray-200"},"折扣碼"),(0,a._)("th",{class:"border-gray-200"},"折扣百分比"),(0,a._)("th",{class:"border-gray-200"},"到期日"),(0,a._)("th",{class:"border-gray-200"},"是否啟用"),(0,a._)("th",{class:"border-gray-200 text-center"},"編 輯"),(0,a._)("th",{class:"border-gray-200 text-center"},"刪 除")])],-1),c={key:0,class:"text-success"},r={key:1,class:"text-muted"},m={class:"text-center"},h=["onClick"],b={class:"text-center"},_=["onClick"],g={class:"card-footer px-3 border-0 d-flex flex-column flex-lg-row align-items-center justify-content-between"},C={class:"small mt-4 mt-lg-0"},y={class:"mb-0"};function f(e,t,o,f,w,v){const k=(0,a.up)("v-loading"),x=(0,a.up)("vue-feather"),M=(0,a.up)("pagination-tool"),D=(0,a.up)("update-coupon-modal"),L=(0,a.up)("delete-modal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",s,[l,(0,a._)("div",i,[(0,a.Wm)(k,{active:w.isLoading},null,8,["active"]),(0,a._)("div",p,[(0,a._)("button",{type:"button",class:"btn btn-ad-primary m-4 px-3 py-2",onClick:t[0]||(t[0]=e=>v.callCouponModal(!0))},"新 增")]),(0,a._)("table",d,[u,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(w.coupons,((e,t)=>((0,a.wg)(),(0,a.iD)("tr",{key:t},[(0,a._)("td",null,(0,n.zw)(e.title),1),(0,a._)("td",null,(0,n.zw)(e.code),1),(0,a._)("td",null,(0,n.zw)(e.percent),1),(0,a._)("td",null,(0,n.zw)(e.due_date),1),1===e.is_enabled?((0,a.wg)(),(0,a.iD)("td",c," 啟用 ")):((0,a.wg)(),(0,a.iD)("td",r," 未啟用 ")),(0,a._)("td",m,[(0,a._)("button",{type:"button",class:"edit-btn border-0 bg-transparent px-3 py-2",onClick:t=>v.callCouponModal(!1,e)},[(0,a.Wm)(x,{type:"edit"})],8,h)]),(0,a._)("td",b,[(0,a._)("button",{type:"button",class:"delete-btn border-0 bg-transparent px-3 py-2",onClick:t=>v.callDeleteCouponModal(e)},[(0,a.Wm)(x,{type:"trash-2"})],8,_)])])))),128))])]),(0,a._)("div",g,[(0,a.Wm)(M,{pages:w.pagination,onEmitPages:v.getCoupons},null,8,["pages","onEmitPages"]),(0,a._)("div",C,[(0,a._)("p",y,"本頁 "+(0,n.zw)(w.coupons.length)+" 筆",1)])])])]),(0,a.Wm)(D,{ref:"couponModal",coupon:w.tempCoupon,"is-new":w.isNew,onUpdateCoupon:v.updateCoupon},null,8,["coupon","is-new","onUpdateCoupon"]),(0,a.Wm)(L,{ref:"deleteModal",item:w.tempCoupon,onDelItem:v.deleteCoupon},null,8,["item","onDelItem"])],64)}var w=o(4295),v=o(7729),k=o(9963);const x={class:"modal fade",id:"couponModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"couponModalLabel","aria-hidden":"true",ref:"modal"},M={class:"modal-dialog"},D={class:"modal-content"},L={class:"modal-header bg-ad-primary text-white"},$={class:"modal-title",id:"couponModalLabel"},N={key:0},U={key:1},W=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),z={class:"modal-body"},P={class:"mb-3"},S=(0,a._)("label",{for:"couponTitle",class:"form-label"},"名稱",-1),T={class:"mb-3"},V=(0,a._)("label",{for:"couponCode",class:"form-label"},"折扣碼",-1),Z={class:"mb-3"},j=(0,a._)("label",{for:"couponPercent",class:"form-label"},"折扣百分比",-1),I={class:"mb-4"},O=(0,a._)("label",{for:"couponDue",class:"form-label"},"到期日",-1),E={class:"form-check mb-3"},H=(0,a._)("label",{for:"is_enabled",class:"form-check-label"},"是否啟用",-1),Y={class:"modal-footer"},B=(0,a._)("button",{type:"button",class:"btn btn-outline-dark","data-bs-dismiss":"modal"},"取 消",-1),K={key:0},q={key:1};function A(e,t,o,n,s,l){return(0,a.wg)(),(0,a.iD)("div",x,[(0,a._)("div",M,[(0,a._)("div",D,[(0,a._)("div",L,[(0,a._)("h5",$,[o.isNew?((0,a.wg)(),(0,a.iD)("span",N,"新增優惠券")):((0,a.wg)(),(0,a.iD)("span",U,"編輯優惠券"))]),W]),(0,a._)("div",z,[(0,a._)("div",P,[S,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control mb-2",name:"coupon-title",id:"couponTitle",placeholder:"請輸入名稱","onUpdate:modelValue":t[0]||(t[0]=e=>s.tempCoupon.title=e),autocomplete:"on"},null,512),[[k.nr,s.tempCoupon.title]])]),(0,a._)("div",T,[V,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control mb-2",name:"coupon-code",id:"couponCode",placeholder:"請輸入折扣碼","onUpdate:modelValue":t[1]||(t[1]=e=>s.tempCoupon.code=e),autocomplete:"on"},null,512),[[k.nr,s.tempCoupon.code]])]),(0,a._)("div",Z,[j,(0,a.wy)((0,a._)("input",{type:"number",class:"form-control mb-2",name:"coupon-percent",id:"couponPercent",placeholder:"請輸入折扣百分比","onUpdate:modelValue":t[2]||(t[2]=e=>s.tempCoupon.percent=e),autocomplete:"on",min:"0"},null,512),[[k.nr,s.tempCoupon.percent]])]),(0,a._)("div",I,[O,(0,a.wy)((0,a._)("input",{type:"date",class:"form-control mb-2",id:"couponDue","onUpdate:modelValue":t[3]||(t[3]=e=>s.due_date=e),autocomplete:"on"},null,512),[[k.nr,s.due_date]])]),(0,a._)("div",E,[(0,a.wy)((0,a._)("input",{type:"checkbox",class:"form-check-input",value:"",id:"is_enabled","onUpdate:modelValue":t[4]||(t[4]=e=>s.tempCoupon.is_enabled=e),"true-value":1,"false-value":0},null,512),[[k.e8,s.tempCoupon.is_enabled]]),H])]),(0,a._)("div",Y,[B,(0,a._)("button",{type:"button",class:"btn btn-ad-primary",onClick:t[5]||(t[5]=t=>e.$emit("update-coupon",s.tempCoupon))},[o.isNew?((0,a.wg)(),(0,a.iD)("span",K,"新增優惠券")):((0,a.wg)(),(0,a.iD)("span",q,"更新優惠券"))])])])])],512)}var F=o(1339),G={props:{coupon:{type:Object,default(){return{}}},isNew:{type:Boolean,default:!1}},data(){return{tempCoupon:{},due_date:""}},mixins:[F.Z],inject:["emitter"],emits:["update-coupon"],watch:{coupon(){this.tempCoupon=this.coupon;const e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T")[this.due_date]=e},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}}},J=o(3744);const Q=(0,J.Z)(G,[["render",A]]);var R=Q,X={props:{config:Object},data(){return{coupons:{},tempCoupon:{title:"",is_enabled:0,percent:100,code:""},isNew:!1,isLoading:!1,pagination:{}}},components:{PaginationTool:w.Z,DeleteModal:v.Z,UpdateCouponModal:R},methods:{getCoupons(e=1){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/v2/api/erinhuang-lab/admin/coupons";this.$http.get(t).then((e=>{this.coupons=e.data.coupons,this.isLoading=!1,this.pagination=e.data.pagination})).catch((e=>{this.isLoading=!1,this.$httpMessageState(e.response,"錯誤訊息")}))},callDeleteCouponModal(e){this.tempCoupon={...e};const t=this.$refs.deleteModal;t.openModal()},deleteCoupon(){const e=`https://vue3-course-api.hexschool.io/v2/api/erinhuang-lab/admin/coupon/${this.tempCoupon.id}`;this.isLoading=!0,this.$http.delete(e).then((e=>{const t=this.$refs.deleteModal;t.hideModal(),this.isLoading=!1,this.getCoupons()})).catch((e=>{this.isLoading=!1,this.$httpMessageState(e.response,"錯誤訊息")}))},callCouponModal(e,t){this.isNew=e,this.isNew?this.tempCoupon={due_date:(new Date).getTime()/1e3}:this.tempCoupon={...t};const o=this.$refs.couponModal;o.openModal()},updateCoupon(e){this.isLoading=!0;let t="https://vue3-course-api.hexschool.io/v2/api/erinhuang-lab/admin/coupon",o="post",a=e;this.isNew||(t=`https://vue3-course-api.hexschool.io/v2/api/erinhuang-lab/admin/coupon/${this.tempCoupon.id}`,o="put",a=this.tempCoupon),this.$http[o](t,{data:a}).then((e=>{this.isLoading=!1;const t=this.$refs.couponModal;t.hideModal(),this.getCoupons()})).catch((e=>{this.isLoading=!1,this.$httpMessageState(e.response,"錯誤訊息")}))}},created(){this.getCoupons()}};const ee=(0,J.Z)(X,[["render",f]]);var te=ee}}]);
//# sourceMappingURL=351.4299fb5a.js.map