"use strict";(self["webpackChunkp_blossom"]=self["webpackChunkp_blossom"]||[]).push([[751],{778:function(t,e,l){l.r(e),l.d(e,{default:function(){return Vt}});var a=l(6252),s=l(3577);const o={class:"container"},i=(0,a._)("h1",{class:"fs-3 py-6"},"商品管理",-1),d={class:"card card-body border-0 shadow table-wrapper table-responsive"},r={class:"text-end"},c={class:"table table-hover align-middle"},n=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{class:"w-20 border-gray-200"},"圖 片"),(0,a._)("th",{class:"border-gray-200"},"名 稱"),(0,a._)("th",{class:"border-gray-200"},"分 類"),(0,a._)("th",{class:"border-gray-200"},"原 價"),(0,a._)("th",{class:"border-gray-200"},"售 價"),(0,a._)("th",{class:"border-gray-200"},"是否啟用"),(0,a._)("th",{class:"border-gray-200 text-center"},"編 輯"),(0,a._)("th",{class:"border-gray-200 text-center"},"刪 除")])],-1),u=["src","alt"],p={class:"fw-normal"},m={class:"fw-normal"},h={class:"fw-normal"},b={class:"fw-bold"},g={key:0,class:"text-success"},_={key:1,class:"text-ad-warning"},f={class:"text-center"},y=["onClick"],P={class:"text-center"},v=["onClick"],w={class:"card-footer px-3 border-0 d-flex flex-column flex-lg-row align-items-center justify-content-between"},U={class:"small mt-4 mt-lg-0"},x={class:"mb-0"};function k(t,e,l,k,M,D){const $=(0,a.up)("v-loading"),C=(0,a.up)("vue-feather"),L=(0,a.up)("pagination-tool"),V=(0,a.up)("update-product-modal"),S=(0,a.up)("delete-modal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",o,[i,(0,a._)("div",d,[(0,a.Wm)($,{active:M.isLoading},null,8,["active"]),(0,a._)("div",r,[(0,a._)("button",{type:"button",class:"btn btn-ad-primary m-4 px-3 py-2",onClick:e[0]||(e[0]=t=>D.callUpdateModal(!0))},"新 增")]),(0,a._)("table",c,[n,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(M.products,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",null,[(0,a._)("img",{src:t.imageUrl,alt:t.title,class:"item-img rounded-3 m-2"},null,8,u)]),(0,a._)("td",null,[(0,a._)("span",p,(0,s.zw)(t.title),1)]),(0,a._)("td",null,[(0,a._)("span",m,(0,s.zw)(t.category),1)]),(0,a._)("td",null,[(0,a._)("span",h,(0,s.zw)(t.origin_price),1)]),(0,a._)("td",null,[(0,a._)("span",b,(0,s.zw)(t.price),1)]),t.is_enabled?((0,a.wg)(),(0,a.iD)("td",g," 啟用 ")):((0,a.wg)(),(0,a.iD)("td",_," 未啟用 ")),(0,a._)("td",f,[(0,a._)("button",{type:"button",class:"edit-btn border-0 bg-transparent px-3 py-2",onClick:e=>D.callUpdateModal(!1,t)},[(0,a.Wm)(C,{type:"edit"})],8,y)]),(0,a._)("td",P,[(0,a._)("button",{type:"button",class:"delete-btn border-0 bg-transparent px-3 py-2",onClick:e=>D.callDeleteModal(t)},[(0,a.Wm)(C,{type:"trash-2"})],8,v)])])))),128))])]),(0,a._)("div",w,[(0,a.Wm)(L,{pages:M.pagination,onEmitPages:D.getProducts},null,8,["pages","onEmitPages"]),(0,a._)("div",U,[(0,a._)("p",x,"本頁 "+(0,s.zw)(M.products.length)+" 筆",1)])])])]),(0,a.Wm)(V,{ref:"updateModal","temp-product":M.tempProduct,"is-new":M.isNew,onUpdateProduct:D.updateProduct},null,8,["temp-product","is-new","onUpdateProduct"]),(0,a.Wm)(S,{ref:"deleteModal",item:M.tempProduct,onDelItem:D.deleteProduct},null,8,["item","onDelItem"])],64)}var M=l(4295),D=l(9963);const $={class:"modal fade",id:"updateModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"updateModalLabel","aria-hidden":"true",ref:"modal"},C={class:"modal-dialog modal-xl"},L={class:"modal-content"},V={class:"modal-header bg-ad-primary text-white"},S={class:"modal-title",id:"updateModalLabel"},N={key:0},F={key:1},I=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),W={class:"modal-body"},j={class:"row"},z={class:"col-4"},Z={class:"mb-3"},T=(0,a._)("label",{for:"imgUrl",class:"form-label"},"圖片連結",-1),H={class:"mb-5"},Y={for:"customFile",class:"form-label"},q=(0,a.Uk)("或 圖片上傳 "),A=["src"],E=(0,a._)("h3",{class:"mb-3"},"多圖新增",-1),K={key:0},B=["onUpdate:modelValue"],O=["src"],G={class:"col-8"},J={class:"pb-4 border-bottom mb-3"},Q={class:"mb-3"},R=(0,a._)("label",{for:"productTitle",class:"form-label"},"標題",-1),X={class:"row"},tt={class:"col"},et={class:"mb-3"},lt=(0,a._)("label",{for:"productCategory",class:"form-label"},"分類",-1),at={class:"col"},st={class:"mb-3"},ot=(0,a._)("label",{for:"productUnit",class:"form-label"},"單位",-1),it={class:"row"},dt={class:"col"},rt={class:"mb-3"},ct=(0,a._)("label",{for:"productPrice",class:"form-label"},"原價",-1),nt={class:"col"},ut={class:"mb-3"},pt=(0,a._)("label",{for:"productSalePrice",class:"form-label"},"售價",-1),mt={class:"pb-4"},ht={class:"mb-3"},bt=(0,a._)("label",{for:"productDescription",class:"form-label"},"產品描述",-1),gt={class:"mb-3"},_t=(0,a._)("label",{for:"productDetail",class:"form-label"},"說明內容",-1),ft={class:"form-check"},yt=(0,a._)("label",{for:"is_enabled",class:"form-check-label"},"是否啟用",-1),Pt={class:"modal-footer"},vt=(0,a._)("button",{type:"button",class:"btn btn-outline-dark","data-bs-dismiss":"modal"},"取 消",-1);function wt(t,e,l,s,o,i){const d=(0,a.up)("vue-feather");return(0,a.wg)(),(0,a.iD)("div",$,[(0,a._)("div",C,[(0,a._)("div",L,[(0,a._)("div",V,[(0,a._)("h5",S,[l.isNew?((0,a.wg)(),(0,a.iD)("span",N,"新增商品")):((0,a.wg)(),(0,a.iD)("span",F,"編輯商品"))]),I]),(0,a._)("div",W,[(0,a._)("div",j,[(0,a._)("div",z,[(0,a._)("div",Z,[T,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control mb-2",name:"img-url",id:"imgUrl",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=t=>o.childProduct.imageUrl=t)},null,512),[[D.nr,o.childProduct.imageUrl]])]),(0,a._)("div",H,[(0,a._)("label",Y,[q,o.status.fileUploading?((0,a.wg)(),(0,a.j4)(d,{key:0,type:"loader",animation:"spin","animation-speed":"slow"})):(0,a.kq)("",!0)]),(0,a._)("input",{type:"file",class:"form-control mb-2",id:"customFile",ref:"fileInput",onChange:e[1]||(e[1]=(...t)=>i.uploadFile&&i.uploadFile(...t))},null,544)]),(0,a._)("img",{src:o.childProduct.imageUrl,class:"img-fluid"},null,8,A),(0,a._)("div",null,[E,Array.isArray(o.childProduct.imagesUrl)?((0,a.wg)(),(0,a.iD)("div",K,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.childProduct.imagesUrl,((t,e)=>((0,a.wg)(),(0,a.iD)("div",{key:e},[(0,a.wy)((0,a._)("input",{type:"text",class:"form-control mb-2",name:"img-url",id:"imgUrl",placeholder:"請輸入圖片連結","onUpdate:modelValue":t=>o.childProduct.imagesUrl[e]=t},null,8,B),[[D.nr,o.childProduct.imagesUrl[e]]]),(0,a._)("img",{src:o.childProduct.imagesUrl[e],class:"img-fluid mb-2"},null,8,O)])))),128)),!o.childProduct.imagesUrl.length||o.childProduct.imagesUrl[o.childProduct.imagesUrl.length-1]?((0,a.wg)(),(0,a.iD)("button",{key:0,type:"button",class:"btn btn-primary btn-sm w-100 mb-2",onClick:e[2]||(e[2]=e=>t.updateProduct.imagesUrl.push(""))},"新增圖片")):((0,a.wg)(),(0,a.iD)("button",{key:1,type:"button",class:"btn btn-outline-danger btn-sm w-100",onClick:e[3]||(e[3]=e=>t.updateProduct.imagesUrl.pop())},"刪除最後一筆圖片"))])):(0,a.kq)("",!0)])]),(0,a._)("div",G,[(0,a._)("div",J,[(0,a._)("div",Q,[R,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control mb-2",name:"product-title",id:"productTitle",placeholder:"請輸入標題","onUpdate:modelValue":e[4]||(e[4]=t=>o.childProduct.title=t),autocomplete:"on"},null,512),[[D.nr,o.childProduct.title]])]),(0,a._)("div",X,[(0,a._)("div",tt,[(0,a._)("div",et,[lt,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control mb-2",name:"product-category",id:"productCategory",placeholder:"請輸入分類","onUpdate:modelValue":e[5]||(e[5]=t=>o.childProduct.category=t),autocomplete:"on"},null,512),[[D.nr,o.childProduct.category]])])]),(0,a._)("div",at,[(0,a._)("div",st,[ot,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control mb-2",name:"product-unit",id:"productUnit",placeholder:"請輸入單位","onUpdate:modelValue":e[6]||(e[6]=t=>o.childProduct.unit=t),autocomplete:"on"},null,512),[[D.nr,o.childProduct.unit]])])])]),(0,a._)("div",it,[(0,a._)("div",dt,[(0,a._)("div",rt,[ct,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control mb-2",name:"product-price",id:"productPrice",placeholder:"請輸入原價","onUpdate:modelValue":e[7]||(e[7]=t=>o.childProduct.origin_price=t),autocomplete:"on"},null,512),[[D.nr,o.childProduct.origin_price,void 0,{number:!0}]])])]),(0,a._)("div",nt,[(0,a._)("div",ut,[pt,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control mb-2",name:"product-sale-price",id:"productSalePrice",placeholder:"請輸入售價","onUpdate:modelValue":e[8]||(e[8]=t=>o.childProduct.price=t),autocomplete:"on"},null,512),[[D.nr,o.childProduct.price,void 0,{number:!0}]])])])])]),(0,a._)("div",mt,[(0,a._)("div",ht,[bt,(0,a.wy)((0,a._)("textarea",{class:"form-control mb-2",id:"productDescription",rows:"2",placeholder:"請輸入產品描述","onUpdate:modelValue":e[9]||(e[9]=t=>o.childProduct.description=t)},null,512),[[D.nr,o.childProduct.description]])]),(0,a._)("div",gt,[_t,(0,a.wy)((0,a._)("textarea",{class:"form-control mb-2",id:"productDetail",rows:"2",placeholder:"請輸入說明內容","onUpdate:modelValue":e[10]||(e[10]=t=>o.childProduct.content=t)},null,512),[[D.nr,o.childProduct.content]])]),(0,a._)("div",ft,[(0,a.wy)((0,a._)("input",{type:"checkbox",class:"form-check-input",value:"",id:"is_enabled","onUpdate:modelValue":e[11]||(e[11]=t=>o.childProduct.is_enabled=t),"true-value":1,"false-value":0},null,512),[[D.e8,o.childProduct.is_enabled]]),yt])])])])]),(0,a._)("div",Pt,[vt,(0,a._)("button",{type:"button",class:"btn btn-ad-primary",onClick:e[12]||(e[12]=e=>t.$emit("update-product",o.childProduct))},"確 認")])])])],512)}var Ut=l(1339),xt={props:{tempProduct:{type:Object,default(){return{}}},isNew:{type:Boolean,default:!1}},data(){return{modal:"",childProduct:{},status:{}}},mixins:[Ut.Z],inject:["emitter"],emits:["update-product"],watch:{tempProduct(){this.childProduct=this.tempProduct,this.childProduct.imagesUrl||(this.childProduct.imagesUrl=[]),this.childProduct.imageUrl||(this.childProduct.imageUrl="")}},methods:{uploadFile(){const t=this.$refs.fileInput.files[0],e=new FormData;e.append("file-to-upload",t);const l="https://vue3-course-api.hexschool.io/v2/api/erinhuang-lab/admin/upload/";this.status.fileUploading=!0,this.$http.post(l,e,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>{this.status.fileUploading=!1,t.data.success?(this.childProduct.imageUrl=t.data.imageUrl,this.$refs.fileInput.value="",this.emitter.emit("push-message",{style:"success",title:"圖片上傳結果",content:t.data.message})):(this.$refs.fileInput.value="",this.emitter.emit("push-message",{style:"danger",title:"圖片上傳結果",content:t.data.message}))})).catch((t=>{this.status.fileUploading=!1,this.$httpMessageState(t.response,"圖片失敗")}))}}},kt=l(3744);const Mt=(0,kt.Z)(xt,[["render",wt]]);var Dt=Mt,$t=l(7729),Ct={data(){return{products:[],tempProduct:{imagesUrl:[]},isNew:!1,pagination:{},currentPage:1,isLoading:!1}},components:{PaginationTool:M.Z,UpdateProductModal:Dt,DeleteModal:$t.Z},inject:["emitter"],methods:{getProducts(t=1){this.currentPage=t;const e=`https://vue3-course-api.hexschool.io/v2/api/erinhuang-lab/admin/products?page=${t}`;this.isLoading=!0,this.$http.get(e).then((t=>{this.products=t.data.products,this.pagination=t.data.pagination,this.isLoading=!1})).catch((t=>{console.dir(t),this.isLoading=!1,this.$httpMessageState(t.response,"錯誤訊息")}))},callUpdateModal(t,e){t?(this.tempProduct={},this.isNew=!0):(this.tempProduct={...e},this.isNew=!1);const l=this.$refs.updateModal;l.openModal()},updateProduct(t){this.tempProduct=t;let e="https://vue3-course-api.hexschool.io/v2/api/erinhuang-lab/admin/product";this.isLoading=!0;let l="post",a="新增商品";this.isNew||(e=`https://vue3-course-api.hexschool.io/v2/api/erinhuang-lab/admin/product/${this.tempProduct.id}`,l="put",a="更新商品"),this.$http[l](e,{data:this.tempProduct}).then((t=>{const e=this.$refs.updateModal;e.hideModal(),this.isLoading=!1,this.getProducts(this.currentPage),this.$httpMessageState(t,a)})).catch((t=>{this.isLoading=!1,this.$httpMessageState(t.response,a)}))},callDeleteModal(t){this.tempProduct={...t};const e=this.$refs.deleteModal;e.openModal()},deleteProduct(t){const e=`https://vue3-course-api.hexschool.io/v2/api/erinhuang-lab/admin/product/${this.tempProduct.id}`;this.isLoading=!0,this.$http.delete(e,{data:this.tempProduct}).then((t=>{const e=this.$refs.deleteModal;e.hideModal(),this.isLoading=!1,this.getProducts(this.currentPage),this.$httpMessageState(t,"刪除產品")})).catch((t=>{this.isLoading=!1,this.$httpMessageState(t.response,"刪除產品")}))}},created(){this.getProducts()}};const Lt=(0,kt.Z)(Ct,[["render",k]]);var Vt=Lt}}]);
//# sourceMappingURL=751.8b345be3.js.map